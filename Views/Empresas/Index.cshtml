@{
    Layout = null;
    string JWTToken = Session["TokenJWT"] as string ?? "";
}
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <link rel="icon" href="~/Utilidades/logoU.png" type="image/x-icon" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UTEC Empresas - Perfil</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.13.1/font/bootstrap-icons.min.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="~/CSS/Empresas.css" rel="stylesheet" />
</head>
<body>
    <div class="header">
        <div class="container">
            <div class="d-flex justify-content-between align-items-center">
                <div class="d-flex align-items-start gap-3">
                    <img class="logo-utec" src="~/Utilidades/logoU.png" />
                    <div class="mt-3">
                        <h5 class="mb-1" id="NombreEmpresa">@Session["UsuarioNombre"]</h5>
                        <p class="company-subtitle mb-0"></p>
                    </div>
                </div>
                <div class="d-none d-md-flex align-items-center gap-3">
                    <div class="dropdown">
                        <button class="btn btn-light btn-sm dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false">
                            <i class="bi bi-list"></i> Opciones
                        </button>
                        <ul class="dropdown-menu">
                            <li><a class="dropdown-item" href="#" onclick="abrirModalBuscarEgresados(); return false;"><i class="bi bi-search"></i> Buscar Egresados</a></li>
                            <li><a class="dropdown-item" href="#" data-bs-toggle="modal" data-bs-target="#modalPublicarVacante"><i class="bi bi-briefcase-fill"></i> Publicar Vacante</a></li>
                            <li><a class="dropdown-item" href="#" onclick="abrirModalPerfil(); return false;"><i class="bi bi-building"></i> Mi Perfil</a></li>
                            <li><a class="dropdown-item" href="#" onclick="abrirModalReportes(); return false;"><i class="bi bi-graph-up"></i> Reportes</a></li>

                            <li><hr class="dropdown-divider"></li>
                            <li><a class="dropdown-item text-danger" href="@Url.Action("CerrarSesion", "Empresas")"><i class="bi bi-box-arrow-left"></i> Cerrar Sesión</a></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="container mt-4">
        <div class="row justify-content-center mb-4">
            <div class="col-6 col-md-4 col-lg-3">
                <div class="stat-card text-center">
                    <div class="stat-icon mx-auto">
                        <i class="fas fa-briefcase"></i>
                    </div>
                    <div class="stat-value">0</div>
                    <div class="stat-label">Vacantes activas</div>
                </div>
            </div>
            <div class="col-6 col-md-4 col-lg-3">
                <div class="stat-card text-center">
                    <div class="stat-icon mx-auto">
                        <i class="fas fa-user-check"></i>
                    </div>
                    <div class="stat-value">0</div>
                    <div class="stat-label">Total candidatos</div>
                </div>
            </div>
            <div class="col-6 col-md-4 col-lg-3">
                <div class="stat-card text-center">
                    <div class="stat-icon mx-auto">
                        <i class="fas fa-bell"></i>
                    </div>
                    <div class="stat-value">0</div>
                    <div class="stat-label">Postulaciones activas</div>
                </div>
            </div>
        </div>

        <div class="row mb-4">
            <div class="col-lg-8 mb-4">
                <div class="stat-card">
                    <h3 class="section-title">Pipeline por Estado</h3>
                    <div style="position: relative; height: 300px;">
                        <canvas id="pipelineChart"></canvas>
                    </div>
                </div>
            </div>

            <div class="col-lg-4 mb-4">
                <div class="stat-card">
                    <h3 class="section-title">Top carreras más contratadas</h3>
                    <div class="mt-3" id="carreras-contratadas-container">
                        <div class="text-center py-3">
                            <div class="spinner-border spinner-border-sm text-muted" role="status">
                                <span class="visually-hidden">Cargando...</span>
                            </div>
                            <p class="text-muted small mt-2">Cargando carreras...</p>
                        </div>
                    </div>
                </div>
            </div>

        </div>

        <style>
            .table-responsive {
                position: relative !important;
                z-index: 1 !important;
            }

                .table-responsive table {
                    position: relative !important;
                    z-index: 1 !important;
                }

                .table-responsive thead,
                .table-responsive tbody,
                .table-responsive tr {
                    position: relative !important;
                    z-index: 1 !important;
                }

            .dropdown-menu {
                z-index: 9999999 !important;
            }
        </style>

        <div class="container">
            <div class="stat-card1">
                <h3 class="section-title1">Vacantes recientes</h3>
                <div id="filtrosVacantesRecientes"></div>

                <div class="table-responsive">
                    <table class="table table-custom1 mb-0" id="tablaVacantes">
                        <thead>
                            <tr>
                                <th>Posición</th>
                                <th>Estado</th>
                                <th>Fecha</th>
                                <th style="width: 150px;">Acciones</th>
                            </tr>
                        </thead>
                        <tbody>
                        </tbody>
                    </table>
                    <div id="vacantesContainer"></div>
                </div>
            </div>
        </div>

    </div>


    <div class="modal fade" id="modalBuscarEgresados" tabindex="-1" data-bs-backdrop="static">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header" style="background-color: #8b1038; color: white;">
                    <h5 class="modal-title">
                        <i class="bi bi-search"></i> Buscar Egresados
                    </h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="row mb-4">
                        <div class="col-md-12">
                            <div class="alert alert-info">
                                <i class="bi bi-info-circle"></i>
                                Solo se muestran egresados con CV público que aceptan ser contactados
                            </div>
                        </div>
                        <div class="col-md-5">
                            <label class="form-label fw-bold">Filtrar por Carrera</label>
                            <input type="text" class="form-control" id="filtroCarreraModal" placeholder="Ej: Ingeniería">
                        </div>
                        <div class="col-md-5">
                            <label class="form-label fw-bold">Filtrar por Habilidad</label>
                            <input type="text" class="form-control" id="filtroHabilidadModal" placeholder="Ej: Python, Liderazgo">
                        </div>
                        <div class="col-md-2">
                            <label class="form-label fw-bold">&nbsp;</label>
                            <button class="btn btn-matching w-100 mb-2" onclick="aplicarFiltrosModal()">
                                <i class="bi bi-search"></i> Buscar
                            </button>
                            <button type="button" class="btn btn-outline-secondary w-100" onclick="limpiarFiltrosModal()" title="Limpiar filtros">
                                <i class="fas fa-times"></i> Limpiar
                            </button>
                        </div>
                    </div>

                    <div id="paginacionEgresadosModalTop" class="mb-3"></div>

                    <div class="text-center py-5" id="loadingEgresados" style="display: none;">
                        <div class="spinner-border" style="color: #8b1038;" role="status">
                            <span class="visually-hidden">Cargando...</span>
                        </div>
                        <p class="mt-3">Buscando egresados...</p>
                    </div>

                    <div class="row" id="listaEgresadosModal">
                    </div>

                    <div class="text-center py-5" id="emptyStateModal" style="display: none;">
                        <i class="bi bi-inbox" style="font-size: 3rem; color: #ccc;"></i>
                        <p class="mt-3 text-muted">No se encontraron egresados</p>
                    </div>

                    <div id="paginacionEgresadosModalBottom" class="mt-3"></div>
                </div>

                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="modalPerfilCompleto" tabindex="-1" data-bs-backdrop="static">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header" style="background-color: #8b1038; color: white;">
                    <h5 class="modal-title">
                        <i class="bi bi-person-badge"></i> Perfil del Egresado
                    </h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body" id="contenidoPerfilCompleto">
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="VerCV" aria-hidden="true" aria-labelledby="VerMiCVToggleLabel" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered modal-xl">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="VerMiCVToggleLabel">Mi CV</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div id="cv-container">
                        <div class="text-center">
                            <div class="spinner-border" role="status">
                                <span class="visually-hidden">Cargando CV...</span>
                            </div>
                            <p class="mt-2">Cargando CV...</p>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
                </div>
            </div>
        </div>
    </div>


    <div class="modal fade" id="modalPerfilEmpresa" tabindex="-1" data-bs-backdrop="static">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header" style="background-color: #8b1038; color: white;">
                    <h5 class="modal-title">
                        <i class="bi bi-building"></i> Mi Perfil de Empresa
                    </h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="row mb-4">
                        <div class="col-md-12">
                            <div class="alert alert-info">
                                <i class="bi bi-info-circle"></i>
                                Actualiza la información de tu empresa. Los campos marcados con <span class="text-danger">*</span> son obligatorios
                            </div>
                        </div>
                    </div>

                    <div class="text-center py-5" id="loadingPerfil" style="display: none;">
                        <div class="spinner-border" style="color: #8b1038;" role="status">
                            <span class="visually-hidden">Cargando...</span>
                        </div>
                        <p class="mt-3">Cargando información...</p>
                    </div>

                    <form id="formPerfil" style="display: none;">
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="razonSocial" class="form-label fw-bold">
                                    Razón Social <span class="text-danger">*</span>
                                </label>
                                <input type="text" class="form-control" id="razonSocial"
                                       placeholder="Nombre de la empresa" required>
                            </div>

                            <div class="col-md-6 mb-3">
                                <label for="nit" class="form-label fw-bold">
                                    NIT <span class="text-danger">*</span>
                                </label>
                                <input type="text" class="form-control" id="nit"
                                       placeholder="0000-000000-000-0" required>
                            </div>

                            <div class="col-md-6 mb-3">
                                <label for="emailContacto" class="form-label fw-bold">
                                    Email de Contacto <span class="text-danger">*</span>
                                </label>
                                <div class="input-group">
                                    <span class="input-group-text"><i class="bi bi-envelope"></i></span>
                                    <input type="email" class="form-control" id="emailContacto"
                                           placeholder="contacto@empresa.com" required>
                                </div>
                            </div>

                            <div class="col-md-6 mb-3">
                                <label for="telefono" class="form-label fw-bold">
                                    Teléfono <span class="text-danger">*</span>
                                </label>
                                <div class="input-group">
                                    <span class="input-group-text"><i class="bi bi-telephone"></i></span>
                                    <input type="text" class="form-control" id="telefono"
                                           placeholder="0000-0000" required>
                                </div>
                            </div>

                            <div class="col-md-12 mb-3">
                                <label for="direccion" class="form-label fw-bold">
                                    Dirección
                                </label>
                                <div class="input-group">
                                    <span class="input-group-text"><i class="bi bi-geo-alt"></i></span>
                                    <input type="text" class="form-control" id="direccion"
                                           placeholder="Dirección física de la empresa">
                                </div>
                            </div>

                            <div class="col-md-6 mb-3">
                                <label for="sectorEconomico" class="form-label fw-bold">
                                    Sector Económico
                                </label>
                                <input type="text" class="form-control" id="sectorEconomico"
                                       placeholder="Ej: Tecnología, Servicios, etc.">
                            </div>

                            <div class="col-md-6 mb-3">
                                <label for="tamanoEmpresa" class="form-label fw-bold">
                                    Tamaño de Empresa
                                </label>
                                <select class="form-select" id="tamanoEmpresa">
                                    <option value="">Seleccionar...</option>
                                    <option value="Microempresa">Microempresa (1-10 empleados)</option>
                                    <option value="Pequeña">Pequeña (11-50 empleados)</option>
                                    <option value="Mediana">Mediana (51-200 empleados)</option>
                                    <option value="Grande">Grande (201-1000 empleados)</option>
                                    <option value="Corporación">Corporación (+1000 empleados)</option>
                                </select>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                        <i class="bi bi-x-circle"></i> Cancelar
                    </button>
                    <button type="button" class="btn btn-matching" onclick="guardarPerfilEmpresa()">
                        <i class="bi bi-save"></i> Guardar Cambios
                    </button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="modalPublicarVacante" tabindex="-1" data-bs-backdrop="static" data-bs-keyboard="false">
        <div class="modal-dialog modal-xl modal-dialog-scrollable">
            <div class="modal-content">
                <div class="modal-header" style="background: linear-gradient(135deg, #8b1038 0%, #6b0d2b 100%); color: white;">
                    <div class="d-flex align-items-center gap-3">
                        <i class="bi bi-briefcase-fill" style="font-size: 2rem;"></i>
                        <div>
                            <h5 class="modal-title mb-0">Publicar Nueva Vacante</h5>
                            <small class="opacity-75">Complete los datos para publicar una nueva oferta laboral</small>
                        </div>
                    </div>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>

                <div class="modal-body" style="background-color: #f8f9fa;">
                    <div class="carousel-section mb-4">
                        <div id="carouselVacantes" class="carousel slide" data-bs-ride="carousel">
                            <div class="carousel-indicators">
                                <button type="button" data-bs-target="#carouselVacantes" data-bs-slide-to="0" class="active"></button>
                                <button type="button" data-bs-target="#carouselVacantes" data-bs-slide-to="1"></button>
                                <button type="button" data-bs-target="#carouselVacantes" data-bs-slide-to="2"></button>
                            </div>

                            <div class="carousel-inner" style="border-radius: 12px; overflow: hidden;">
                                <div class="carousel-item active">
                                    <img src="~/Utilidades/IMG5.jpg" style="height: 300px; width: 100%; object-fit: cover;" alt="Paso 1">
                                    <div class="position-absolute top-0 start-0 m-3 badge bg-primary" style="font-size: 1rem;">
                                        <i class="bi bi-1-circle-fill"></i> Paso 1
                                    </div>
                                    <div class="carousel-caption">
                                        <h5><i class="bi bi-file-text-fill"></i> Define la Vacante</h5>
                                        <p>Completa el título, requisitos, salario y detalles del puesto</p>
                                    </div>
                                </div>

                                <div class="carousel-item">
                                    <img src="~/Utilidades/IMG6.jpg" style="height: 300px; width: 100%; object-fit: cover;" alt="Paso 2">
                                    <div class="position-absolute top-0 start-0 m-3 badge bg-primary" style="font-size: 1rem;">
                                        <i class="bi bi-2-circle-fill"></i> Paso 2
                                    </div>
                                    <div class="carousel-caption">
                                        <h5><i class="bi bi-gear-fill"></i> Configura los Detalles</h5>
                                        <p>Establece ubicación, modalidad, tipo de contrato y fecha de cierre</p>
                                    </div>
                                </div>

                                <div class="carousel-item">
                                    <img src="~/Utilidades/IMG7.jpg" style="height: 300px; width: 100%; object-fit: cover;" alt="Paso 3">
                                    <div class="position-absolute top-0 start-0 m-3 badge bg-primary" style="font-size: 1rem;">
                                        <i class="bi bi-3-circle-fill"></i> Paso 3
                                    </div>
                                    <div class="carousel-caption">
                                        <h5><i class="bi bi-rocket-takeoff-fill"></i> Publica y Recibe Candidatos</h5>
                                        <p>Tu vacante estará visible para todos los egresados</p>
                                    </div>
                                </div>
                            </div>

                            <button class="carousel-control-prev" type="button" data-bs-target="#carouselVacantes" data-bs-slide="prev">
                                <span class="carousel-control-prev-icon"></span>
                            </button>
                            <button class="carousel-control-next" type="button" data-bs-target="#carouselVacantes" data-bs-slide="next">
                                <span class="carousel-control-next-icon"></span>
                            </button>
                        </div>
                    </div>

                    <div class="progress mb-4" style="height: 6px;">
                        <div class="progress-bar" id="progressBarVacante" role="progressbar" style="width: 0%; background-color: #8b1038;"></div>
                    </div>

                    <div class="bg-white p-4 rounded shadow-sm">
                        <form id="formVacante">
                            <div class="mb-4">
                                <label class="form-label fw-bold">
                                    <i class="bi bi-pencil-fill text-primary"></i> Título de la vacante <span class="text-danger">*</span>
                                </label>
                                <input type="text" id="titulo" name="titulo" class="form-control form-control-lg" maxlength="100" placeholder="Ej: Desarrollador Full Stack Senior">
                                <small class="text-muted"><i class="bi bi-info-circle"></i> Sea específico y atractivo en el título</small>
                            </div>

                            <div class="border-start border-4 border-warning ps-3 mb-4">
                                <h6 class="text-uppercase text-muted mb-3"><i class="bi bi-currency-dollar"></i> Información Salarial</h6>

                                <div class="row mb-3">
                                    <div class="col-md-6 mb-3 mb-md-0">
                                        <label class="form-label fw-bold">Salario mínimo (USD) <span class="text-danger">*</span></label>
                                        <div class="input-group">
                                            <span class="input-group-text"><i class="bi bi-currency-dollar"></i></span>
                                            <input type="number" id="salario_min" name="SalarioMin" class="form-control" placeholder="1200" step="0.01" min="0">
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <label class="form-label fw-bold">Salario máximo (USD) <span class="text-danger">*</span></label>
                                        <div class="input-group">
                                            <span class="input-group-text"><i class="bi bi-currency-dollar"></i></span>
                                            <input type="number" id="salario_max" name="SalarioMax" class="form-control" placeholder="1800" step="0.01" min="0">
                                        </div>
                                    </div>
                                </div>

                                <div class="mb-3">
                                    <label class="form-label fw-bold">
                                        <i class="bi bi-shield-lock-fill"></i> ¿Mantener salario confidencial?
                                    </label>
                                    <select id="salario_confidencial" name="SalarioConfidencial" class="form-select">
                                        <option value="false">No - Mostrar rango salarial públicamente</option>
                                        <option value="true">Sí - Mantener confidencial</option>
                                    </select>
                                </div>
                            </div>

                            <div class="border-start border-4 border-info ps-3 mb-4">
                                <h6 class="text-uppercase text-muted mb-3"><i class="bi bi-list-check"></i> Requisitos y Detalles</h6>

                                <div class="mb-3">
                                    <label class="form-label fw-bold">
                                        <i class="bi bi-briefcase-fill"></i> Área de trabajo <span class="text-danger">*</span>
                                    </label>
                                    <input type="text"
                                           id="area_trabajo"
                                           name="AreaTrabajo"
                                           class="form-control"
                                           placeholder="Ejemplo: Tecnología, Ventas, Marketing, Recursos Humanos, etc."
                                           maxlength="100"
                                           required>
                                    <small class="text-muted">
                                        <i class="bi bi-info-circle"></i> Especifica el departamento o área de la empresa donde trabajará el candidato
                                    </small>
                                </div>

                                <div class="mb-3">
                                    <label class="form-label fw-bold">Requisitos del candidato <span class="text-danger">*</span></label>
                                    <textarea id="requisitos" name="Requisitos" class="form-control" rows="5" maxlength="1000" placeholder="Ejemplo:&#10;• Experiencia mínima de 2-3 años en desarrollo web&#10;• Dominio de JavaScript, React y Node.js&#10;• Título universitario en Ingeniería o carrera afín&#10;• Inglés intermedio/avanzado"></textarea>
                                    <small class="text-muted"><i class="bi bi-lightbulb-fill"></i> Usa viñetas (•) o guiones (-) para mejor legibilidad</small>
                                </div>

                                <div class="mb-3">
                                    <label class="form-label fw-bold">
                                        <i class="bi bi-clock-fill"></i> Tipo de contrato <span class="text-danger">*</span>
                                    </label>
                                    <select id="tipo_contrato" name="TipoContrato" class="form-select">
                                        <option value="">-- Seleccionar --</option>
                                        <option value="Tiempo completo"> Tiempo completo</option>
                                        <option value="Medio tiempo"> Medio tiempo</option>
                                        <option value="Por proyecto"> Por proyecto</option>
                                        <option value="Temporal"> Temporal</option>
                                        <option value="Pasantía"> Pasantía</option>
                                    </select>
                                </div>
                            </div>

                            <div class="border-start border-4 border-success ps-3 mb-4">
                                <h6 class="text-uppercase text-muted mb-3"><i class="bi bi-geo-alt-fill"></i> Ubicación y Modalidad</h6>

                                <div class="mb-3">
                                    <label class="form-label fw-bold">Ubicación <span class="text-danger">*</span></label>
                                    <div class="input-group">
                                        <span class="input-group-text"><i class="bi bi-map-fill"></i></span>
                                        <input type="text" id="ubicacion" name="Ubicacion" class="form-control" placeholder="Ej: San Salvador, El Salvador">
                                    </div>
                                </div>

                                <div class="mb-3">
                                    <label class="form-label fw-bold">
                                        <i class="bi bi-laptop-fill"></i> Modalidad de trabajo <span class="text-danger">*</span>
                                    </label>
                                    <select id="modalidad" name="Modalidad" class="form-select">
                                        <option value="">-- Seleccionar --</option>
                                        <option value="Presencial"> Presencial</option>
                                        <option value="Remoto"> Remoto</option>
                                        <option value="Híbrido"> Híbrido</option>
                                    </select>
                                </div>
                            </div>

                            <div class="border-start border-4 border-danger ps-3 mb-4">
                                <h6 class="text-uppercase text-muted mb-3"><i class="bi bi-calendar-check"></i> Publicación</h6>

                                <div class="row">
                                    <div class="col-md-6 mb-3">
                                        <label class="form-label fw-bold">
                                            <i class="bi bi-calendar-x-fill"></i> Fecha de cierre <span class="text-danger">*</span>
                                        </label>
                                        <input type="date" id="fecha_cierre" name="FechaCierre" class="form-control">
                                        <small class="text-muted">Fecha límite para recibir postulaciones</small>
                                    </div>
                                    <div class="col-md-6 mb-3">
                                        <label class="form-label fw-bold">
                                            <i class="bi bi-toggle-on"></i> Estado inicial <span class="text-danger">*</span>
                                        </label>
                                        <select id="estado" name="Estado" class="form-select">
                                            <option value="Activa"> Activa - Publicar inmediatamente</option>
                                            <option value="Borrador"> Borrador - Guardar sin publicar</option>
                                        </select>
                                    </div>
                                </div>
                            </div>

                            <input type="hidden" id="id_empresa" name="IdEmpresa" value="1">
                        </form>
                    </div>
                </div>

                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                        <i class="bi bi-x-circle"></i> Cancelar
                    </button>
                    <button type="button" class="btn btn-primary" onclick="guardarVacante()" style="background-color: #8b1038; border-color: #8b1038;">
                        <i class="bi bi-check-circle"></i> Publicar Vacante
                    </button>
                </div>
            </div>
        </div>
    </div>
    <div class="modal fade" id="modalCambiarEstado" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title"><i class="bi bi-arrow-repeat"></i> Cambiar Estado</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="mb-3">
                        <label class="form-label fw-bold">Vacante:</label>
                        <p class="mb-0" id="modalCambioVacante"></p>
                    </div>
                    <div class="mb-3">
                        <label class="form-label fw-bold">Estado actual:</label>
                        <p><span class="badge-custom" id="modalCambioEstadoActual"></span></p>
                    </div>
                    <hr>
                    <div class="mb-3">
                        <label for="selectEstado" class="form-label fw-bold">Seleccionar nuevo estado:</label>
                        <select class="form-select" id="selectEstado">
                            <option value="Abierta">Abierta</option>
                            <option value="En Revisión">En Revisión</option>
                            <option value="Entrevista">Entrevista</option>
                            <option value="Oferta">Oferta</option>
                            <option value="Contratado">Contratado</option>
                            <option value="Cerrado">Cerrado</option>
                        </select>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                    <button type="button" class="btn btn-primary" onclick="confirmarCambioEstado()">
                        <i class="bi bi-check-circle"></i> Confirmar Cambio
                    </button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="modalVerDetalles" tabindex="-1" data-bs-backdrop="static">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header" style="background-color: #8b1038; color: white;">
                    <h5 class="modal-title">
                        <i class="bi bi-eye"></i> Detalles de la Vacante
                    </h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div id="contenidoDetallesVacante">
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                        <i class="bi bi-x-circle"></i> Cerrar
                    </button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="modalEditarVacante" tabindex="-1" data-bs-backdrop="static">
        <div class="modal-dialog modal-xl modal-dialog-scrollable">
            <div class="modal-content">
                <div class="modal-header" style="background-color: #8b1038; color: white;">
                    <h5 class="modal-title">
                        <i class="bi bi-pencil-square"></i> Editar Vacante
                    </h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body" style="background-color: #f8f9fa;">
                    <form id="formEditarVacante">
                        <input type="hidden" id="edit_id_vacante">

                        <div class="bg-white p-4 rounded shadow-sm mb-3">
                            <h6 class="text-uppercase text-muted mb-3">
                                <i class="bi bi-file-text"></i> Información Básica
                            </h6>

                            <div class="mb-3">
                                <label for="edit_titulo" class="form-label fw-bold">
                                    Título de la vacante <span class="text-danger">*</span>
                                </label>
                                <input type="text" id="edit_titulo" class="form-control" maxlength="100">
                            </div>

                            <div class="mb-3">
                                <label for="edit_descripcion" class="form-label fw-bold">
                                    Descripción
                                </label>
                                <textarea id="edit_descripcion" class="form-control" rows="3" maxlength="500"></textarea>
                            </div>

                            <div class="mb-3">
                                <label for="edit_requisitos" class="form-label fw-bold">
                                    Requisitos <span class="text-danger">*</span>
                                </label>
                                <textarea id="edit_requisitos" class="form-control" rows="5" maxlength="1000"></textarea>
                            </div>

                            <div class="mb-3">
                                <label for="edit_area" class="form-label fw-bold">
                                    Área de trabajo <span class="text-danger">*</span>
                                </label>
                                <input type="text" id="edit_area" class="form-control" maxlength="100">
                            </div>
                        </div>

                        <div class="bg-white p-4 rounded shadow-sm mb-3">
                            <h6 class="text-uppercase text-muted mb-3">
                                <i class="bi bi-currency-dollar"></i> Información Salarial
                            </h6>

                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <label for="edit_salario_min" class="form-label fw-bold">
                                        Salario mínimo (USD) <span class="text-danger">*</span>
                                    </label>
                                    <div class="input-group">
                                        <span class="input-group-text">$</span>
                                        <input type="number" id="edit_salario_min" class="form-control" step="0.01" min="0">
                                    </div>
                                </div>
                                <div class="col-md-6 mb-3">
                                    <label for="edit_salario_max" class="form-label fw-bold">
                                        Salario máximo (USD) <span class="text-danger">*</span>
                                    </label>
                                    <div class="input-group">
                                        <span class="input-group-text">$</span>
                                        <input type="number" id="edit_salario_max" class="form-control" step="0.01" min="0">
                                    </div>
                                </div>
                            </div>

                            <div class="mb-3">
                                <label for="edit_salario_confidencial" class="form-label fw-bold">
                                    ¿Salario confidencial?
                                </label>
                                <select id="edit_salario_confidencial" class="form-select">
                                    <option value="false">No - Mostrar rango salarial</option>
                                    <option value="true">Sí - Mantener confidencial</option>
                                </select>
                            </div>
                        </div>

                        <div class="bg-white p-4 rounded shadow-sm mb-3">
                            <h6 class="text-uppercase text-muted mb-3">
                                <i class="bi bi-geo-alt"></i> Ubicación y Modalidad
                            </h6>

                            <div class="mb-3">
                                <label for="edit_ubicacion" class="form-label fw-bold">
                                    Ubicación <span class="text-danger">*</span>
                                </label>
                                <input type="text" id="edit_ubicacion" class="form-control">
                            </div>

                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <label for="edit_modalidad" class="form-label fw-bold">
                                        Modalidad <span class="text-danger">*</span>
                                    </label>
                                    <select id="edit_modalidad" class="form-select">
                                        <option value="">-- Seleccionar --</option>
                                        <option value="Presencial"> Presencial</option>
                                        <option value="Remoto"> Remoto</option>
                                        <option value="Híbrido"> Híbrido</option>
                                    </select>
                                </div>
                                <div class="col-md-6 mb-3">
                                    <label for="edit_tipo_contrato" class="form-label fw-bold">
                                        Tipo de contrato <span class="text-danger">*</span>
                                    </label>
                                    <select id="edit_tipo_contrato" class="form-select">
                                        <option value="">-- Seleccionar --</option>
                                        <option value="Tiempo completo"> Tiempo completo</option>
                                        <option value="Medio tiempo"> Medio tiempo</option>
                                        <option value="Por proyecto"> Por proyecto</option>
                                        <option value="Temporal"> Temporal</option>
                                        <option value="Pasantía"> Pasantía</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <div class="bg-white p-4 rounded shadow-sm">
                            <h6 class="text-uppercase text-muted mb-3">
                                <i class="bi bi-calendar-check"></i> Fechas y Estado
                            </h6>

                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <label for="edit_fecha_cierre" class="form-label fw-bold">
                                        Fecha de cierre <span class="text-danger">*</span>
                                    </label>
                                    <input type="date" id="edit_fecha_cierre" class="form-control">
                                </div>
                                <div class="col-md-6 mb-3">
                                    <label for="edit_estado" class="form-label fw-bold">
                                        Estado <span class="text-danger">*</span>
                                    </label>
                                    <select id="edit_estado" class="form-select">
                                        <option value="Abierta"> Abierta</option>
                                        <option value="Borrador"> Borrador</option>
                                        <option value="En Revisión"> En Revisión</option>
                                        <option value="Entrevista"> Entrevista</option>
                                        <option value="Oferta"> Oferta</option>
                                        <option value="Contratado">Contratado</option>
                                        <option value="Cerrado"> Cerrado</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                        <i class="bi bi-x-circle"></i> Cancelar
                    </button>
                    <button type="button" class="btn btn-primary" onclick="guardarEdicionVacante()"
                            style="background-color: #8b1038; border-color: #8b1038;">
                        <i class="bi bi-save"></i> Guardar Cambios
                    </button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="modalVerCandidatos" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title"><i class="bi bi-people"></i> Candidatos Aplicados</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="mb-3">
                        <h6 class="fw-bold">Vacante: <span id="modalCandidatosVacante"></span></h6>
                        <p class="text-muted">Total de candidatos: <span id="modalCandidatosTotal"></span></p>
                    </div>
                    <hr>
                    <div class="alert alert-info">
                        <i class="bi bi-info-circle"></i> Esta funcionalidad mostraría la lista completa de candidatos aplicados a esta vacante.
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="modalEliminarVacante" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header bg-danger text-white">
                    <h5 class="modal-title"><i class="bi bi-exclamation-triangle"></i> Eliminar Vacante</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="alert alert-warning">
                        <i class="bi bi-exclamation-circle"></i> Esta acción no se puede deshacer.
                    </div>
                    <p class="mb-3">¿Estás seguro de que deseas eliminar la vacante?</p>
                    <div class="alert alert-danger mb-0">
                        <strong id="modalEliminarNombre"></strong>
                        <p class="mb-0 mt-2 small">Candidatos asociados: <span id="modalEliminarCandidatos"></span></p>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                    <button type="button" class="btn btn-danger" onclick="confirmarEliminacion()">
                        <i class="bi bi-trash"></i> Sí, Eliminar
                    </button>
                </div>
            </div>
        </div>
    </div>


    <div class="modal fade" id="modalVerPostulaciones" tabindex="-1"data-backdrop="false" data-bs-backdrop="static">
        <div class="modal-dialog modal-xl modal-dialog-scrollable">
            <div class="modal-content">
                <div class="modal-header" style="background-color: #8b1038; color: white;">
                    <div>
                        <h5 class="modal-title">
                            <i class="bi bi-people-fill"></i> Gestión de Postulaciones
                        </h5>
                        <small id="nombreVacantePostulaciones" class="opacity-75"></small>
                    </div>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="alert alert-info d-flex justify-content-between align-items-center">
                        <span>
                            <i class="bi bi-info-circle"></i> Total de postulaciones:
                        </span>
                        <span class="badge bg-primary" style="font-size: 1.2rem;" id="totalPostulaciones">0</span>
                    </div>

                    <ul class="nav nav-tabs mb-3" id="postulacionesTabs" role="tablist">
                        <li class="nav-item" role="presentation">
                            <button class="nav-link active" id="proceso-tab" data-bs-toggle="tab"
                                    data-bs-target="#tabProceso" type="button" role="tab">
                                <i class="bi bi-arrow-repeat"></i> Candidatos en Proceso
                                <span class="badge bg-warning text-dark ms-2" id="contadorProceso">0</span>
                            </button>
                        </li>
                        <li class="nav-item" role="presentation">
                            <button class="nav-link" id="contratados-tab" data-bs-toggle="tab"
                                    data-bs-target="#tabContratados" type="button" role="tab">
                                <i class="bi bi-check-circle"></i> Candidatos Contratados
                                <span class="badge bg-success ms-2" id="contadorContratados">0</span>
                            </button>
                        </li>
                    </ul>

                    <div class="text-center py-5" id="loadingPostulaciones" style="display: none;">
                        <div class="spinner-border" style="color: #8b1038;" role="status">
                            <span class="visually-hidden">Cargando...</span>
                        </div>
                        <p class="mt-3">Cargando postulaciones...</p>
                    </div>

                    <div class="tab-content" id="postulacionesTabContent">
                        <div class="tab-pane fade show active" id="tabProceso" role="tabpanel">
                            <div class="table-responsive">
                                <table class="table table-custom mb-0" id="tablaPostulaciones" style="overflow: visible;">
                                    <thead>
                                        <tr class="text-center">
                                            <th>Candidato</th>
                                            <th>Carrera</th>
                                            <th width="17%">Contacto</th>
                                            <th width="8%">Promedio</th>
                                            <th width="10%">Estado</th>
                                            <th width="13%">Fecha Postulación</th>
                                            <th width="13%">Acciones</th>
                                        </tr>
                                    </thead>
                                    <tbody id="contenidoPostulaciones" class="text-center">
                                    </tbody>
                                </table>
                            </div>

                            <div class="text-center py-5" id="emptyStatePostulaciones" style="display: none;">
                                <i class="bi bi-inbox" style="font-size: 3rem; color: #ccc;"></i>
                                <p class="mt-3 text-muted">No hay candidatos en proceso para esta vacante</p>
                            </div>
                        </div>

                        <div class="tab-pane fade" id="tabContratados" role="tabpanel">
                            <div class="table-responsive">
                                <table class="table table-custom mb-0">
                                    <thead>
                                        <tr>
                                            <th>Candidato</th>
                                            <th>Carrera</th>
                                            <th>Promedio</th>
                                            <th>Estado</th>
                                            <th>Fecha Contratación</th>
                                            <th width="20%">Acciones</th>
                                        </tr>
                                    </thead>
                                    <tbody id="contenidoContratados">
                                    </tbody>
                                </table>
                            </div>

                            <div class="text-center py-5" id="emptyStateContratados" style="display: none;">
                                <i class="bi bi-person-check" style="font-size: 3rem; color: #ccc;"></i>
                                <p class="mt-3 text-muted">No hay candidatos contratados para esta vacante</p>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                        <i class="bi bi-x-circle"></i> Cerrar
                    </button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="modalCalificarEgresado" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header bg-warning">
                    <h5 class="modal-title">
                        <i class="bi bi-star-fill"></i> Calificar Candidato
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <input type="hidden" id="idPostulacionCalificar" />
                    <input type="hidden" id="calificacionSeleccionada" value="0" />

                    <div class="text-center mb-4">
                        <p class="mb-2">Calificar a:</p>
                        <h5 class="text-primary" id="nombreEgresadoCalificar"></h5>
                    </div>

                    <div id="calificacionActualMensaje" class="alert alert-info d-none mb-3">
                        <i class="bi bi-info-circle-fill"></i>
                        <strong>Calificación actual:</strong> <span id="textoCalificacionActual"></span>
                    </div>

                    <div class="text-center mb-3">
                        <p class="mb-3"><strong>Selecciona la calificación:</strong></p>
                        <div class="btn-group btn-group-lg" role="group">
                            <button type="button" class="btn btn-outline-warning btn-calificacion"
                                    onclick="seleccionarCalificacion(1)" title="1 estrella">
                                ⭐
                            </button>
                            <button type="button" class="btn btn-outline-warning btn-calificacion"
                                    onclick="seleccionarCalificacion(2)" title="2 estrellas">
                                ⭐
                            </button>
                            <button type="button" class="btn btn-outline-warning btn-calificacion"
                                    onclick="seleccionarCalificacion(3)" title="3 estrellas">
                                ⭐
                            </button>
                            <button type="button" class="btn btn-outline-warning btn-calificacion"
                                    onclick="seleccionarCalificacion(4)" title="4 estrellas">
                                ⭐
                            </button>
                            <button type="button" class="btn btn-outline-warning btn-calificacion"
                                    onclick="seleccionarCalificacion(5)" title="5 estrellas">
                                ⭐
                            </button>
                        </div>
                    </div>

                    <div class="alert alert-secondary mt-3">
                        <i class="bi bi-lightbulb"></i>
                        <small>Esta calificación ayuda a identificar los mejores candidatos</small>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                        <i class="bi bi-x-circle"></i> Cancelar
                    </button>
                    <button type="button" class="btn btn-warning" onclick="guardarCalificacion()">
                        <i class="bi bi-star-fill"></i> Guardar Calificación
                    </button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="modalContactarEgresado" tabindex="-1" data-bs-backdrop="static">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header bg-primary text-white">
                    <h5 class="modal-title">
                        <i class="bi bi-envelope-fill"></i> Contactar Candidato
                    </h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <input type="hidden" id="idPostulacionContactar" />

                    <div class="alert alert-info">
                        <i class="bi bi-info-circle"></i>
                        <strong>Enviando mensaje a:</strong>
                        <div class="mt-2">
                            <strong id="nombreEgresadoContactar"></strong>
                            <p class="mb-0 text-muted small">
                                <i class="bi bi-envelope"></i> <span id="emailEgresadoContactar"></span>
                            </p>
                        </div>
                    </div>

                    <div class="mb-3">
                        <label for="asuntoContactoEgresado" class="form-label fw-bold">
                            <i class="bi bi-tag"></i> Asunto:
                        </label>
                        <input type="text"
                               class="form-control"
                               id="asuntoContactoEgresado"
                               placeholder="Ej: Oportunidad Laboral"
                               maxlength="200">
                    </div>

                    <div class="mb-3">
                        <label for="mensajeContactoEgresado" class="form-label fw-bold">
                            <i class="bi bi-chat-left-text"></i> Mensaje para el candidato:
                        </label>
                        <textarea class="form-control"
                                  id="mensajeContactoEgresado"
                                  rows="10"
                                  maxlength="2000"
                                  placeholder="Escriba su mensaje aquí..."
                                  style="resize: vertical;"></textarea>
                        <small class="text-muted">
                            <i class="bi bi-lightbulb"></i>
                            Mínimo 50 caracteres. Sea claro y profesional en su comunicación.
                        </small>
                    </div>

                    <div class="alert alert-warning">
                        <i class="bi bi-exclamation-triangle"></i>
                        <strong>Importante:</strong> Este mensaje se enviará por correo electrónico al candidato.
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                        <i class="bi bi-x-circle"></i> Cancelar
                    </button>
                    <button type="button" class="btn btn-primary" onclick="enviarContactoEgresado()">
                        <i class="bi bi-send-fill"></i> Enviar Mensaje
                    </button>
                </div>
            </div>
        </div>
    </div>


    <div class="modal fade" id="modalReportes" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header" style="background-color: #8b1038; color: white;">
                    <h5 class="modal-title">
                        <i class="bi bi-graph-up"></i> Generar Reportes Excel
                    </h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="text-center mb-4">
                        <i class="bi bi-file-earmark-spreadsheet-fill" style="font-size: 3rem; color: #8b1038;"></i>
                        <h4 class="mt-3">Reportes Estadísticos</h4>
                        <p class="text-muted">Selecciona el tipo de reporte que deseas generar y descargar en formato Excel</p>
                    </div>

                    <div class="mb-4">
                        <label for="tipoReporte" class="form-label fw-bold">
                            <i class="bi bi-funnel"></i> Tipo de Reporte
                        </label>
                        <select class="form-select form-select-lg" id="tipoReporte">
                        </select>
                        <small class="text-muted">
                            <i class="bi bi-info-circle"></i> Selecciona un reporte para ver las opciones disponibles
                        </small>
                    </div>

                    <div id="contenedorOpcionesReporte"></div>

                    <div class="alert alert-info border-0 shadow-sm">
                        <div class="d-flex align-items-start">
                            <i class="bi bi-lightbulb-fill me-3 mt-1" style="font-size: 1.5rem;"></i>
                            <div>
                                <strong>¿Qué incluyen los reportes?</strong>
                                <ul class="mb-0 mt-2 small">
                                    <li>Datos estadísticos completos y actualizados</li>
                                    <li>Formato profesional en Excel (.xlsx)</li>
                                    <li>Tablas organizadas y fáciles de analizar</li>
                                    <li>Información lista para presentaciones</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <div class="text-center mt-4">
                        <button type="button"
                                class="btn btn-success btn-lg px-5 py-3 shadow"
                                onclick="descargarReporte()"
                                style="border-radius: 10px;">
                            <i class="bi bi-download me-2" style="font-size: 1.2rem;"></i>
                            <span style="font-size: 1.1rem;">Descargar Reporte</span>
                        </button>
                        <p class="text-muted small mt-3 mb-0">
                            <i class="bi bi-clock-history"></i> El archivo se descargará automáticamente en tu carpeta de descargas
                        </p>
                    </div>
                </div>
                <div class="modal-footer bg-light">
                    <div class="d-flex align-items-center me-auto text-muted small">
                        <i class="bi bi-shield-check me-2"></i>
                        Datos seguros y confidenciales
                    </div>
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                        <i class="bi bi-x-circle"></i> Cerrar
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/toastify-js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <script>
        const JWT_TOKEN = '@JWTToken';
        var nombreEmpresa = '';
    </script>
    <script src="~/JS/Empresas.js"></script>
</body>
</html>